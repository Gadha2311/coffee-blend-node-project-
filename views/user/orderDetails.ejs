<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Responsive Bootstrap4 Shop Template, Created by Imran Hossain from https://imransdesign.com/">

	<!-- title -->
	<title>Coffee Blend</title>

	


	<!-- google font -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
	<!-- fontawesome -->
	<link rel="stylesheet" href="/user_assets/css/all.min.css">
	<!-- bootstrap -->
	<link rel="stylesheet" href="/user_assets/bootstrap/css/bootstrap.min.css">
	<!-- owl carousel -->
	<link rel="stylesheet" href="/user_assets/css/owl.carousel.css">
	<!-- magnific popup -->
	<link rel="stylesheet" href="/user_assets/css/magnific-popup.css">
	<!-- animate css -->
	<link rel="stylesheet" href="/user_assets/css/animate.css">
	<!-- mean menu css -->
	<link rel="stylesheet" href="/user_assets/css/meanmenu.min.css">
	<!-- main style -->
	<link rel="stylesheet" href="/user_assets/css/main.css">
	<!-- responsive -->
	<link rel="stylesheet" href="/user_assets/css/responsive.css">

	<style>
		.star-rating {
            display: inline-block;
            font-size: 2rem;
        }

        .star-rating input {
            display: none;
        }

        .star-rating label {
            display: inline-block;
            cursor: pointer;
            color: #ddd;
        }

        .star-rating label:before {
            content: '\2605'; /* Unicode character for a star */
            display: inline-block;
        }
        
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.7);
}

.modal-content {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #fff;
  padding: 20px;
  border-radius: 8px;
}

.close {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 20px;
  cursor: pointer;
}


        
.cancelled-row {
    filter: blur(2px); /* Adjust the blur effect as needed */
    background-color: lightgray; /* Adjust the background color for cancelled rows */
    color: red; /* Adjust the text color for cancelled rows */
}
   

    .order-tracking h1 {
        color: #3b5d50;
        font-size: 28px;
        font-weight: 600;
        margin-bottom: 20px;
    }

    .tracking-dots {
        display: flex;
        justify-content: space-between;
    }

    .tracking-lines {
    display: flex;
    justify-content: space-between;
    position: relative;
}

.line {
    flex: 1;
    height: 3px;
    background-color: #008000; /* Set the color of the connecting line */
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: -1; /* Set the z-index to position the lines behind the dots */
}

.dot {
    width: 30px;
    height: 30px;
    background-color: #f7faf9;
    border-radius: 50%;
    animation: moveDot 1s infinite alternate;
    position: relative;
    z-index: 1; 
}


#pendingDot::before {
    content: '';
    width: calc(100% - 30px); 
    left: 50%;
    transform: translateX(-50%);
}
#processingDot::before {
    content: '';
    width: calc(100% - 60px); 
    left: 50%;
    transform: translateX(-50%);
}
#shippedDot::before {
    content: '';
    width: calc(100% - 90px); 
    left: 50%;
    transform: translateX(-50%);
}
#deliveredDot::before {
    content: '';
    width: calc(100% - 120px); 
    left: 50%;
    transform: translateX(-50%);
}
	</style>
</head>
<body>
	
	
	
	<!-- header -->
	<div class="top-header-area" id="sticker">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 col-sm-12 text-center">
					<div class="main-menu-wrap">
						
						<div class="site-logo">
							<a href="index.html">
								<img src="" alt="">
							</a>
						</div>
						<!-- logo -->

						<!-- menu start -->
						<nav class="main-menu">
							<ul>
								<li class="current-list-item"><a href="/">Home</a></li>
								<li><a href="/shop">shop</a></li>
								
								<li><a href="contact.html">Contact</a></li>
								<li>
								<a href="#">category</a>
								<ul class="sub-menu">
									<li class="nav-item">
									<% categories.filter(category => category.status !== false).forEach(category => { %>
									<li> <!-- Wrap each sub-category item in its own list item -->
									<a class="dropdown-item" href="/shop?category=<%= category._id %>">
										<%= category.name %>
									</a>
									</li>
									<% }); %>
									</li>
								</ul>
								</li>		
								<li>
									<div class="header-icons">
										<a class="shopping-cart" href="/cartpage"><i class="fas fa-shopping-cart"></i></a>
										<a class="mobile-hide search-bar-icon" href="#"><i class="fas fa-heart"></i></a>
                                        <a class="mobile-hide search-bar-icon" href="/profile"><i class="fas fa-user"></i></a>
									</div>
									<div class="search-bar">
										<form action="/searchProducts"method='post'>
										  <input name="searchProducts" type="text" class="search-input" placeholder="Search...">
										  <button class="search-button"><img src="/user_assets/img/search-50.png" style="height: 20px;"></button>
										  </form>
										</div>
								</li>
							</ul>
						<!-- menu end -->
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end header -->
	
    <div style="background-color: black; height: 150px;"></div>


    <div style="margin-bottom: 1px; padding-top: 50px;" class="hero"style="margin-bottom:1px">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="intro-excerpt">
                      
                      <div class="order-info">
                        <div class="row">
                            <div class="col-lg-6">
                                <h2 style="font-size: 30px;">Order ID: <%= order.orderId %></h2>
                            </div>
                            <div class="col-lg-6">
                                <div class="btn-action text-md-end">
                                    <a href="/download-invoice/<%= order.orderId %>" style="background-color: #F28123;"href="#" class="btn btn-primary">Download Invoice</a>
                                </div>
                            </div>
                        </div>
                    
                        <p><strong>Payment Method:</strong> <%=order.paymentMethod%></p>
                        <p><strong>Ordered On:</strong><%= order.createdAt.toLocaleString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })%>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div style="background-color: #efeeee; border: solid #3b5d50;border-radius: 50px;margin-bottom: 10px;margin-top: 1px;" class="container order-details">
        <div class="row">
            <!-- Order Address Section (Add actual address data) -->
            <div style="color:#3b5d50; padding: 50px;" class="col-md-6">
                <div class="order-address">
                    <h3>Order Address</h3>
                    <p style="font-size: 20px;"><%=order.shippingAddress.fullname%><br><%=order.shippingAddress.adname%>&nbsp;,&nbsp;<%=order.shippingAddress.street%><br><%=order.shippingAddress.city%>&nbsp;,&nbsp;<%=order.shippingAddress.pincode%><br><%=order.shippingAddress.phonenumber%></p>

                    
                </div>
            </div>

            <!-- Order Tracking Section -->
            <div class="col-md-6">
                <div class="order-tracking">
                    <h1>Order Status: <%= order.status %> <span id="orderStatus"></span></h1>
                    <p>Updated at:<%= order.updatedAt %> <span id="updatedAt"></span></p>
                    <div class="tracking-dots" id="trackingDots">
                        <div class="dot" id="pendingDot" data-step="1"><p></p></div>
                        <div class="dot" id="processingDot" data-step="2"><p></p></div>
                        <div class="dot" id="shippedDot" data-step="3"><p></p></div>
                        <div class="dot" id="deliveredDot" data-step="4"><p></p></div>
                    </div>
                   
                </div>
            </div>
        </div>


        <!-- Order Items Section (Add actual order items data) -->
        <div class="order-items">
            <h3>Order Items</h3>
            <table class="table">
                <thead>
                    <tr>
                        <th>Item Name</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Item Total</th>
                    </tr>
                </thead>
                <tbody>
                  <% order.items.forEach(item =>{%>
                    <tr>
                        <td><%=item.productName%></td>
                        <td><%=item.singleprice%></td>
                        <td><%=item.quantity%></td>
                        <td><%=item.price%></td>
                    </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>

        <!-- Order Total Section (Add actual order total data) -->
        <div class="order-total">
            
            <h2><strong>Total Amount:</strong><%=order.totalPrice%></h2>
            <div style="margin-top: 30px; margin-bottom:12px;margin-left: 500px;">
                <% if (order.status !== 'Cancelled' && order.status !== 'Returned' && order.status !== 'Delivered') { %>
                  
					<a style="background-color: rgb(181, 0, 0); width: 350px;" href="#" class="btn btn-danger" onclick="confirmCancel('<%= order._id %>')">Cancel</a>
                <% } else if (order.status === 'Delivered') { %>
                  
                    <a style="background-color: rgb(198, 3, 3)(172, 53, 53);" href="/returnorder/<%=order._id%>" class="btn btn-danger">Return</a>
                <% } %>
				<% order.items.forEach(item => { %>
					<% if (item.status !== 'cancelled' && order.status == 'Delivered') { %>
						<a  class="btn btn-danger" style="background-color: rgb(208, 210, 70);font-size: 20px;" onclick="openModal('<%= item.productId %>')">Rate the product</a>
					<% } %>
				<% }); %>
            
            </div>
			<div class="modal" id="rateAndReviewModal" style="display: none;">
				<div class="modal-content" style="width: 30%;">
					<span class="close" onclick="closeModal()">&times;</span>
					<h2 style="text-align: center;">Rate and Review</h2>
					<form method="get" action="/rateAndReview" id="rateAndReviewForm">
						<div class="star-rating">
							<input type="radio" id="star1" name="rating" value="1">
							<label for="star1" onclick="handleRating(1)"></label>
							<input type="radio" id="star2" name="rating" value="2">
							<label for="star2" onclick="handleRating(2)"></label>
							<input type="radio" id="star3" name="rating" value="3">
							<label for="star3" onclick="handleRating(3)"></label>
							<input type="radio" id="star4" name="rating" value="4">
							<label for="star4" onclick="handleRating(4)"></label>
							<input type="radio" id="star5" name="rating" value="5">
							<label for="star5" onclick="handleRating(5)"></label>
						</div>
						<label for="review">Review:</label>
						<textarea id="review" name="review" rows="4" required></textarea>
						<input type="hidden" name="id" id="productIdInput" value="">
						<button  class="btn btn-danger" type="submit" style="width: 100%;background-color: rgb(208, 210, 70);">Submit</button>
					</form>
				</div>
			</div>

        </div>

        
        
    </div>

    
	<!-- footer -->
	<div class="footer-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<div class="footer-box about-widget">
						<h2 class="widget-title">About us</h2>
						<p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts.</p>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box get-in-touch">
						<h2 class="widget-title">Get in Touch</h2>
						<ul>
							<li>203 Fake St. Mountain View, San Francisco, California, USA.</li>
							<li>support@coffeeblenf.com</li>
							<li>+00 111 222 3333</li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box pages">
						<h2 class="widget-title">Pages</h2>
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="about.html">Menu</a></li>
							<li><a href="services.html">Shop</a></li>
							<li><a href="contact.html">Contact</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box subscribe">
						<h2 class="widget-title">Subscribe</h2>
						<p>Subscribe to our mailing list to get the latest updates.</p>
						<form action="index.html">
							<input type="email" placeholder="Email">
							<button type="submit"><i class="fas fa-paper-plane"></i></button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end footer -->
	
	<!-- copyright -->
	<div class="copyright">
		<div class="container">
			<div class="row">
				<!-- <div class="col-lg-6 col-md-12">
					<p>Copyrights &copy; 2019 - <a href="https://imransdesign.com/">Imran Hossain</a>,  All Rights Reserved.<br>
						Distributed By - <a href="https://themewagon.com/">Themewagon</a>
					</p>
				</div> -->
				<div class="col-lg-6 text-right col-md-12">
					<div class="social-icons">
						<ul>
							<li><a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-instagram"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-linkedin"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-dribbble"></i></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end copyright -->
	
	<script>
		function confirmCancel(orderId) {
			var confirmed = confirm("Are you sure you want to cancel this order?");
			if (confirmed) {
				window.location.href = "/cancelorder/" + orderId;
			}
		}
	</script>
  <script>
	function openModal(productId) {
  console.log(productId);
  document.getElementById('productIdInput').value = productId;

document.getElementById('rateAndReviewModal').style.display = 'block';
}

function closeModal() {
document.getElementById('rateAndReviewModal').style.display = 'none';
}
  </script>
  <script>
	
  const starInputs = document.querySelectorAll('.star-rating input');


starInputs.forEach(function (input) {
  input.addEventListener('click', function () {
	  const clickedValue = parseInt(this.value);

	  
	  starInputs.forEach(function (input) {
		  const starValue = parseInt(input.value);
		  const label = input.nextElementSibling; 

		  if (starValue <= clickedValue) {
			  label.style.color = 'gold';
		  } else {
			  label.style.color = '#ddd'; 
		  }
	  });
  });
});
  </script>

	<!-- jquery -->
	<script src="/user_assets/js/jquery-1.11.3.min.js"></script>
	<!-- bootstrap -->
	<script src="/user_assets/bootstrap/js/bootstrap.min.js"></script>
	<!-- count down -->
	<script src="/user_assets/js/jquery.countdown.js"></script>
	<!-- isotope -->
	<script src="/user_assets/js/jquery.isotope-3.0.6.min.js"></script>
	<!-- waypoints -->
	<script src="/user_assets/js/waypoints.js"></script>
	<!-- owl carousel -->
	<script src="/user_assets/js/owl.carousel.min.js"></script>
	<!-- magnific popup -->
	<script src="/user_assets/js/jquery.magnific-popup.min.js"></script>
	<!-- mean menu -->
	<script src="/user_assets/js/jquery.meanmenu.min.js"></script>
	<!-- sticker js -->
	<script src="/user_assets/js/sticker.js"></script>
	<!-- main js -->
	<script src="/user_assets/js/main.js"></script>

</body>
</html>